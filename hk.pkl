amends "package://github.com/jdx/hk/releases/download/v1.32.0/hk@1.32.0#/Config.pkl"
import "package://github.com/jdx/hk/releases/download/v1.32.0/hk@1.32.0#/Builtins.pkl"

local linters = new Mapping<String, Step> {
  ["check-merge-conflict"] = Builtins.check_merge_conflict
  ["check_added_large_files"] = Builtins.check_added_large_files
  ["dclint"] {
    glob =
      List(
        "**/compose*.yml",
        "**/compose*.yaml",
        "**/docker-compose*.yml",
        "**/docker-compose*.yaml",
      )
    exclude = List("**/node_modules/**", "**/target/**")
    check = "dclint {{files}}"
    fix = "dclint --fix {{files}}"
    batch = true
  }
  ["markdown"] = Builtins.markdown_lint
  ["google_java_format"] {
    glob = List("**/*.java")
    exclude = List("**/target/**")
    check = "google-java-format --dry-run --set-exit-if-changed {{files}}"
    fix = "google-java-format --replace {{files}}"
    batch = true
  }
  ["mise"] = Builtins.mise
  ["mixed_line_ending"] = Builtins.mixed_line_ending
  ["newlines"] = Builtins.newlines
  ["pkl"] = Builtins.pkl
  ["pkl_format"] = Builtins.pkl_format
  ["sql_fluff"] = Builtins.sql_fluff
  ["trailing-whitespace"] = Builtins.trailing_whitespace
  ["yaml"] = Builtins.yamlfmt
}

hooks {
  ["pre-commit"] {
    fix = true
    stash = "git"
    steps = linters
  }
  ["pre-push"] {
    steps = linters
  }
  ["fix"] {
    fix = true
    steps = linters
  }
  ["check"] {
    steps = linters
  }
}
