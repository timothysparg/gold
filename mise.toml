[tools]
hk = "1.32.0"
java = "oracle-graalvm-25.0.1"
pkl = "0.30.2"
yamlfmt = "0.21.0"
"github:google/google-java-format" = "1.34.1"
node = "lts"
"npm:markdownlint-cli" = "v0.47.0"
"npm:dclint" = "3.1.0"
uv = "0.10.2"
pipx = "latest"
"pipx:sqlfluff" = "4.0.4"
actionlint = "1.7.10"
fnox = "1.12.1"
shellcheck = "0.11.0"

[tasks.build]
description = "Build and test the project with Maven"
run = "./mvnw clean install"

[tasks."build:native"]
description = "Compile a native executable using the Maven native profile"
run = "./mvnw native:compile -Pnative"

[tasks."build:native-image"]
description = "Build a native container image using Spring Boot buildpacks"
run = "./mvnw spring-boot:build-image -Pnative"

[tasks.check]
description = "Run hk validation checks configured for the project"
run = "hk check"

[tasks.fix]
description = "Apply hk automatic fixes configured for the project"
run = "hk fix"

[env]
_.fnox-env = { tools = true }
HK_MISE = true
env_cache = true
env_cache_ttl = "4h"
experimental = true

[plugins]
fnox-env = "https://github.com/jdx/mise-env-fnox"

[hooks]
enter = '''
if ! grep -q "hk run" .git/hooks/pre-commit 2>/dev/null; then
  hk install --mise
fi
'''
